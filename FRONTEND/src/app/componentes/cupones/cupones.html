<div class="cupones-container">
  <!-- Header -->
  <div class="cupones-header">
    <div class="header-content">
      <div class="header-title">
        <div class="title-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </div>
        <div class="title-text">
          <h1>Mis Cupones</h1>
          <p>Aprovecha nuestras ofertas exclusivas y ahorra en tus pedidos</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Estadísticas -->
  <div class="stats-section">
    <div class="stat-card">
      <div class="stat-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ estadisticas.cuponesDisponibles }}</div>
        <div class="stat-label">Cupones Disponibles</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7z"></path>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">S/ {{ estadisticas.ahorradoEsteMes }}</div>
        <div class="stat-label">Ahorrado Este Mes</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22,4 12,14.01 9,11.01"></polyline>
        </svg>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ estadisticas.cuponesUsados }}</div>
        <div class="stat-label">Cupones Usados</div>
      </div>
    </div>
  </div>

  <!-- Pestañas -->
  <div class="tabs-section">
    <div class="tabs-container">
      <button 
        class="tab-button" 
        [class.active]="tabActivo === 'disponibles'"
        (click)="cambiarTab('disponibles')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
        <span>Disponibles</span>
        <span class="tab-count">{{ cuponesDisponibles.length }}</span>
      </button>

      <button 
        class="tab-button" 
        [class.active]="tabActivo === 'usados'"
        (click)="cambiarTab('usados')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22,4 12,14.01 9,11.01"></polyline>
        </svg>
        <span>Usados</span>
        <span class="tab-count">{{ cuponesUsados.length }}</span>
      </button>

      <button 
        class="tab-button" 
        [class.active]="tabActivo === 'expirados'"
        (click)="cambiarTab('expirados')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12,6 12,12 16,14"></polyline>
        </svg>
        <span>Expirados</span>
        <span class="tab-count">{{ cuponesExpirados.length }}</span>
      </button>
    </div>
  </div>

  <!-- Lista de Cupones -->
  <div class="cupones-list">
    @if (tabActivo === 'disponibles') {
      @for (cupon of cuponesDisponibles; track cupon.id) {
        <div class="cupon-card available">
          <div class="cupon-header">
            <div class="cupon-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </div>
            <div class="cupon-info">
              <h3>{{ cupon.descripcion }}</h3>
              <div class="cupon-details">
                <span class="descuento">{{ formatearDescuento(cupon) }}</span>
                <span class="monto-minimo">Compra mínima: S/ {{ cupon.montoMinimo }}</span>
              </div>
            </div>
          </div>
          <div class="cupon-body">
            <div class="cupon-code">
              <span class="code-label">Código:</span>
              <span class="code-value">{{ cupon.codigo }}</span>
            </div>
            <div class="cupon-validity">
              <span class="validity-label">Válido hasta:</span>
              <span class="validity-value">{{ formatearFecha(cupon.fechaFin) }}</span>
            </div>
          </div>
          <div class="cupon-actions">
            <button class="btn-copy" (click)="copiarCodigo(cupon.codigo)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
              Copiar
            </button>
            <button class="btn-apply" (click)="aplicarCupon(cupon)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 11H5a2 2 0 0 0-2 2v3c0 1.1.9 2 2 2h4m0-7v7m0-7h10a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H9m0-7V9a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"></path>
                <path d="M9 7h6v4H9z"></path>
              </svg>
              Aplicar Ahora
            </button>
          </div>
        </div>
      }
    }

    @if (tabActivo === 'usados') {
      @for (cupon of cuponesUsados; track cupon.id) {
        <div class="cupon-card used">
          <div class="cupon-header">
            <div class="cupon-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22,4 12,14.01 9,11.01"></polyline>
              </svg>
            </div>
            <div class="cupon-info">
              <h3>{{ cupon.descripcion }}</h3>
              <div class="cupon-details">
                <span class="descuento">{{ formatearDescuento(cupon) }}</span>
                <span class="fecha-uso">Usado el {{ formatearFecha(cupon.fechaUso!) }}</span>
              </div>
            </div>
          </div>
          <div class="cupon-body">
            <div class="cupon-code">
              <span class="code-label">Código:</span>
              <span class="code-value">{{ cupon.codigo }}</span>
            </div>
            <div class="cupon-status">
              <span class="status-badge used">Usado</span>
            </div>
          </div>
        </div>
      }
    }

    @if (tabActivo === 'expirados') {
      @for (cupon of cuponesExpirados; track cupon.id) {
        <div class="cupon-card expired">
          <div class="cupon-header">
            <div class="cupon-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12,6 12,12 16,14"></polyline>
              </svg>
            </div>
            <div class="cupon-info">
              <h3>{{ cupon.descripcion }}</h3>
              <div class="cupon-details">
                <span class="descuento">{{ formatearDescuento(cupon) }}</span>
                <span class="fecha-expiracion">Expiró el {{ formatearFecha(cupon.fechaFin) }}</span>
              </div>
            </div>
          </div>
          <div class="cupon-body">
            <div class="cupon-code">
              <span class="code-label">Código:</span>
              <span class="code-value">{{ cupon.codigo }}</span>
            </div>
            <div class="cupon-status">
              <span class="status-badge expired">Expirado</span>
            </div>
          </div>
        </div>
      }
    }

    @if ((tabActivo === 'disponibles' && cuponesDisponibles.length === 0) ||
         (tabActivo === 'usados' && cuponesUsados.length === 0) ||
         (tabActivo === 'expirados' && cuponesExpirados.length === 0)) {
      <div class="empty-state">
        <div class="empty-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12c0 1.2-4.03 6-9 6s-9-4.8-9-6c0-1.2 4.03-6 9-6s9 4.8 9 6z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </div>
        <h3>No hay cupones</h3>
        <p>No tienes cupones en esta categoría</p>
      </div>
    }
  </div>
</div>

